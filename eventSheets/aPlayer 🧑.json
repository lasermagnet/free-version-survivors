{
	"name": "aPlayer ðŸ§‘",
	"events": [
		{
			"aceType": "action",
			"aceName": "tick",
			"objectClass": "Player",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionCopyPicked": false,
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "custom-ace-block",
			"conditions": [
				{
					"id": "compare-eventvar",
					"objectClass": "System",
					"sid": 860097898078923,
					"parameters": {
						"variable": "isLeveling",
						"comparison": 0,
						"value": "NO"
					}
				},
				{
					"id": "compare-instance-variable",
					"objectClass": "Player",
					"sid": 402391089457723,
					"parameters": {
						"instance-variable": "isDead",
						"comparison": 0,
						"value": "NO"
					}
				},
				{
					"id": "compare-eventvar",
					"objectClass": "System",
					"sid": 703410617402308,
					"parameters": {
						"variable": "isPaused",
						"comparison": 0,
						"value": "NO"
					}
				}
			],
			"actions": [
				{
					"type": "comment",
					"text": "Handle input first"
				},
				{
					"customAction": "tick_input",
					"objectClass": "Player",
					"sid": 406681418686896
				},
				{
					"type": "comment",
					"text": "Initialize health bar if needed"
				},
				{
					"id": "set-instvar-value",
					"objectClass": "UI_Bar_Health",
					"sid": 813525834457805,
					"parameters": {
						"instance-variable": "initWidth",
						"value": "Self.initWidth = 0 ? Self.Width : Self.initWidth"
					}
				},
				{
					"type": "comment",
					"text": "Reset hurt state"
				},
				{
					"id": "set-instvar-value",
					"objectClass": "Player",
					"sid": 925351740225164,
					"parameters": {
						"instance-variable": "isHurt",
						"value": "NO"
					}
				},
				{
					"type": "comment",
					"text": "Override analog input if digital is active"
				},
				{
					"id": "set-instvar-value",
					"objectClass": "Player",
					"sid": 385077939272710,
					"parameters": {
						"instance-variable": "IN_Movement_Angle",
						"value": "Self.IN_Vector_X <> 0 | Self.IN_Vector_Y <> 0 ?\nangle(0, 0, Self.IN_Vector_X, Self.IN_Vector_Y) :\nSelf.IN_Movement_Angle"
					}
				},
				{
					"type": "comment",
					"text": "Update 8-direction behaviour vectors"
				},
				{
					"id": "set-vector-x",
					"objectClass": "Player",
					"sid": 838033699443888,
					"behaviorType": "8Direction",
					"parameters": {
						"vector-x": "Self.IN_Movement_Active = YES ? cos(Self.IN_Movement_Angle) * Self.8Direction.MaxSpeed : 0"
					}
				},
				{
					"id": "set-vector-y",
					"objectClass": "Player",
					"sid": 864564382317125,
					"behaviorType": "8Direction",
					"parameters": {
						"vector-y": "Self.IN_Movement_Active = YES ? sin(Self.IN_Movement_Angle) * Self.8Direction.MaxSpeed : 0"
					}
				},
				{
					"type": "comment",
					"text": "Update last moving angle (for attacks) if player is moving"
				},
				{
					"id": "set-instvar-value",
					"objectClass": "Player",
					"sid": 918445174337675,
					"parameters": {
						"instance-variable": "lastMovingAngle",
						"value": "Self.IN_Movement_Active = YES ? Self.IN_Movement_Angle : Self.lastMovingAngle"
					}
				},
				{
					"type": "comment",
					"text": "Update animation (idle or walking)"
				},
				{
					"id": "set-animation",
					"objectClass": "Player",
					"sid": 852166438523850,
					"parameters": {
						"animation": "Self.IN_Movement_Active = YES ? ANIM_Walking : ANIM_Idle",
						"from": "current-frame"
					}
				},
				{
					"type": "comment",
					"text": "Mirror player based on its movement angle (if movement is active)"
				},
				{
					"id": "set-width",
					"objectClass": "Player",
					"sid": 704391484159753,
					"parameters": {
						"width": "Self.IN_Movement_Active = YES ?\n(\n  anglediff(180, Self.IN_Movement_Angle) < 80 ?\r\n  -abs(Self.Width) :\r\n  (\r\n    anglediff(0, Self.IN_Movement_Angle) < 80 ? abs(Self.Width) : Self.Width\r\n  )\n) :\nSelf.Width"
					}
				},
				{
					"type": "comment",
					"text": "Flash / unflash according to the \"flash on\" timer"
				},
				{
					"id": "set-default-color",
					"objectClass": "Player",
					"sid": 904537207197884,
					"parameters": {
						"color": "Self.Timer.CurrentTime(TIMER_FlashOn) > 0 ? rgbEx(500, 500, 500): rgbEx(100, 100, 100)"
					}
				},
				{
					"type": "comment",
					"text": "Regenerate health"
				},
				{
					"id": "set-value",
					"objectClass": "Rules",
					"sid": 984643965871395,
					"parameters": {
						"path": "KEY_Player & DOT & KEY_Health",
						"value": "min(Rules.Get(KEY_Player & DOT & KEY_Health) + dt * Rules.Get(KEY_Player & DOT & KEY_Bonus_Regeneration_Amount) * Rules.Get(KEY_Player & DOT & KEY_Bonus_Healing_Multiplier), Rules.Get(KEY_Player & DOT & KEY_Health_Max))"
					}
				},
				{
					"type": "comment",
					"text": "Tick all \"subroutines\""
				},
				{
					"customAction": "tick_levelUp",
					"objectClass": "Player",
					"sid": 848037988801680
				},
				{
					"customAction": "tick_attack",
					"objectClass": "Player",
					"sid": 999288460373505
				},
				{
					"customAction": "tick_spawnCycle",
					"objectClass": "Player",
					"sid": 316939747583400
				},
				{
					"customAction": "tick_itemPickups",
					"objectClass": "Player",
					"sid": 324678648570010
				},
				{
					"customAction": "tick_attractDrops",
					"objectClass": "Player",
					"sid": 743745607634445
				},
				{
					"customAction": "tick_pickupDrops",
					"objectClass": "Player",
					"sid": 951991278869773
				},
				{
					"customAction": "tick_takeDamage",
					"objectClass": "Player",
					"sid": 130659401245213
				},
				{
					"customAction": "tick_healthCheck",
					"objectClass": "Player",
					"sid": 892364115359393
				},
				{
					"customAction": "tick_wave",
					"objectClass": "Player",
					"sid": 830484081604924
				}
			],
			"sid": 567046003726085
		},
		{
			"aceType": "action",
			"aceName": "tick_attractDrops",
			"objectClass": "Player",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionCopyPicked": false,
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "custom-ace-block",
			"conditions": [
				{
					"id": "is-on-screen",
					"objectClass": "Drop",
					"sid": 123041055328802
				},
				{
					"id": "compare-instance-variable",
					"objectClass": "Drop",
					"sid": 972174143643228,
					"parameters": {
						"instance-variable": "isCollected",
						"comparison": 0,
						"value": "NO"
					}
				},
				{
					"id": "pick-by-comparison",
					"objectClass": "System",
					"sid": 266169878350619,
					"parameters": {
						"object": "Drop",
						"expression": "distance(Drop.X, Drop.Y, Player.X, Player.Y)",
						"comparison": 2,
						"value": "Rules.Get(KEY_Player & DOT & KEY_PickupDistance)"
					}
				}
			],
			"actions": [
				{
					"id": "set-enabled",
					"objectClass": "Drop",
					"sid": 124271299229955,
					"behaviorType": "Bullet",
					"parameters": {
						"state": "enabled"
					}
				}
			],
			"sid": 270908935167114
		},
		{
			"aceType": "action",
			"aceName": "tick_pickupDrops",
			"objectClass": "Player",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionCopyPicked": false,
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "custom-ace-block",
			"conditions": [
				{
					"id": "is-overlapping-another-object",
					"objectClass": "Player",
					"sid": 673808905104997,
					"parameters": {
						"object": "Drop"
					}
				},
				{
					"id": "for-each",
					"objectClass": "System",
					"sid": 681364775555878,
					"parameters": {
						"object": "Drop"
					}
				}
			],
			"actions": [
				{
					"customAction": "playSFX",
					"objectClass": "Audio",
					"sid": 605243333581659,
					"parameters": [
						"SFX_Drop_ & Drop.AnimationName",
						"0",
						"1"
					]
				},
				{
					"type": "comment",
					"text": "Set \"picked up\" state & destroy drop"
				},
				{
					"id": "set-instvar-value",
					"objectClass": "Drop",
					"sid": 366274515581688,
					"parameters": {
						"instance-variable": "isCollected",
						"value": "YES"
					}
				},
				{
					"id": "destroy",
					"objectClass": "Drop",
					"sid": 390770805038106
				},
				{
					"type": "comment",
					"text": "Player: collect experience (with bonus applied)"
				},
				{
					"id": "add-to",
					"objectClass": "Rules",
					"sid": 468368626575325,
					"parameters": {
						"path": "KEY_Player & DOT & KEY_Experience",
						"value": "Drop.experience > 0 ? round(Drop.experience * Rules.Get(KEY_Player & DOT & KEY_Bonus_Experience_Multiplier)) : 0"
					}
				},
				{
					"type": "comment",
					"text": "Player: collect healing (with bonus applied)"
				},
				{
					"id": "set-value",
					"objectClass": "Rules",
					"sid": 764186276805891,
					"parameters": {
						"path": "KEY_Player & DOT & KEY_Health",
						"value": "min(Rules.Get(KEY_Player & DOT & KEY_Health) + Drop.healing * Rules.Get(KEY_Player & DOT & KEY_Bonus_Healing_Multiplier), Rules.Get(KEY_Player & DOT & KEY_Health_Max))"
					}
				}
			],
			"sid": 497434341150514,
			"children": [
				{
					"eventType": "comment",
					"text": "Magnet drop: start picking up experience drops within magnet distance"
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "is-animation-playing",
							"objectClass": "Drop",
							"sid": 488073157951568,
							"parameters": {
								"animation": "ANIM_Magnet"
							}
						},
						{
							"id": "pick-all",
							"objectClass": "System",
							"sid": 369841772210856,
							"parameters": {
								"object": "Drop"
							}
						},
						{
							"id": "is-animation-playing",
							"objectClass": "Drop",
							"sid": 497854117493364,
							"parameters": {
								"animation": "ANIM_Experience"
							}
						},
						{
							"id": "pick-by-comparison",
							"objectClass": "System",
							"sid": 918643275889356,
							"parameters": {
								"object": "Drop",
								"expression": "distance(Drop.X, Drop.Y, Player.X, Player.Y)",
								"comparison": 2,
								"value": "Rules.Get(KEY_Player & DOT & KEY_PickupDistanceMagnet)"
							}
						}
					],
					"actions": [
						{
							"id": "set-enabled",
							"objectClass": "Drop",
							"sid": 593490135055299,
							"behaviorType": "Bullet",
							"parameters": {
								"state": "enabled"
							}
						}
					],
					"sid": 589625546167992
				}
			]
		},
		{
			"aceType": "action",
			"aceName": "tick_levelUp",
			"objectClass": "Player",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionCopyPicked": false,
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "custom-ace-block",
			"conditions": [
				{
					"id": "compare-value",
					"objectClass": "Rules",
					"sid": 870521276127901,
					"parameters": {
						"path": "KEY_Player & DOT & KEY_Experience",
						"cmp": 5,
						"value": "Rules.Get(KEY_Player & DOT & KEY_Experience_Target)"
					}
				}
			],
			"actions": [
				{
					"customAction": "playSFX",
					"objectClass": "Audio",
					"sid": 334770550814119,
					"parameters": [
						"SFX_LevelUp",
						"0",
						"1"
					]
				},
				{
					"type": "comment",
					"text": "Increase player level counter"
				},
				{
					"id": "add-to-instvar",
					"objectClass": "Player",
					"sid": 436285909196078,
					"parameters": {
						"instance-variable": "level",
						"value": "1"
					}
				},
				{
					"type": "comment",
					"text": "Update time scale of moving objects"
				},
				{
					"id": "set-object-time-scale",
					"objectClass": "System",
					"sid": 425149658303130,
					"parameters": {
						"object": "Weapon",
						"time-scale": "0"
					}
				},
				{
					"id": "set-object-time-scale",
					"objectClass": "System",
					"sid": 905246524024994,
					"parameters": {
						"object": "Drop",
						"time-scale": "0"
					}
				},
				{
					"id": "set-object-time-scale",
					"objectClass": "System",
					"sid": 864489562043173,
					"parameters": {
						"object": "Enemy",
						"time-scale": "0"
					}
				},
				{
					"id": "set-object-time-scale",
					"objectClass": "System",
					"sid": 681386880054939,
					"parameters": {
						"object": "Player",
						"time-scale": "0"
					}
				},
				{
					"id": "set-object-time-scale",
					"objectClass": "System",
					"sid": 702063493907075,
					"parameters": {
						"object": "PlayerParticles",
						"time-scale": "0"
					}
				},
				{
					"id": "set-object-time-scale",
					"objectClass": "System",
					"sid": 153641463942966,
					"parameters": {
						"object": "UI_TextSF_Damage",
						"time-scale": "0"
					}
				},
				{
					"id": "set-object-time-scale",
					"objectClass": "System",
					"sid": 388168400491553,
					"parameters": {
						"object": "UI_TextSF_Wave",
						"time-scale": "0"
					}
				},
				{
					"type": "comment",
					"text": "Set \"is leveling\" state"
				},
				{
					"id": "set-eventvar-value",
					"objectClass": "System",
					"sid": 593754245958473,
					"parameters": {
						"variable": "isLeveling",
						"value": "YES"
					}
				},
				{
					"type": "comment",
					"text": "Hide touch marker"
				},
				{
					"id": "set-opacity",
					"objectClass": "UI_TouchMarker",
					"sid": 290540883052382,
					"parameters": {
						"opacity": "0"
					}
				},
				{
					"type": "comment",
					"text": "Show level up UI"
				},
				{
					"id": "set-default-color",
					"objectClass": "UI_Button9P_Upgrade",
					"sid": 205992895652769,
					"parameters": {
						"color": "C_Color_Brown"
					}
				},
				{
					"id": "stop-all-tweens",
					"objectClass": "UI_Border_LevelUp",
					"sid": 388636822598985,
					"behaviorType": "Tween"
				},
				{
					"id": "set-opacity",
					"objectClass": "UI_Border_LevelUp",
					"sid": 857452596406580,
					"parameters": {
						"opacity": "0"
					}
				},
				{
					"id": "set-visible",
					"objectClass": "UI_Border_LevelUp",
					"sid": 927608118606448,
					"parameters": {
						"visibility": "visible"
					}
				},
				{
					"id": "tween-one-property",
					"objectClass": "UI_Border_LevelUp",
					"sid": 404253743647973,
					"behaviorType": "Tween",
					"parameters": {
						"tags": "TWEEN_LevelUp_FadeIn",
						"property": "offsetOpacity",
						"end-value": "100",
						"time": "C_UI_LevelUp_Tween_Time",
						"ease": "easeoutcubic",
						"destroy-on-complete": "no",
						"loop": "no",
						"ping-pong": "no",
						"repeat-count": "1"
					}
				},
				{
					"type": "comment",
					"text": "Clear upgrade options"
				},
				{
					"id": "set-instvar-value",
					"objectClass": "UI_Button9P_Upgrade",
					"sid": 792323419393420,
					"parameters": {
						"instance-variable": "modifier",
						"value": "EMPTY"
					}
				},
				{
					"id": "set-text",
					"objectClass": "UI_TextSF_Upgrade",
					"sid": 667935558937044,
					"parameters": {
						"text": "EMPTY"
					}
				},
				{
					"id": "set-size",
					"objectClass": "UpgradeOptions",
					"sid": 303695715160826,
					"parameters": {
						"width": "0",
						"height": "1",
						"depth": "1"
					}
				}
			],
			"sid": 873626486402719,
			"children": [
				{
					"eventType": "variable",
					"name": "upgradeCandidate",
					"type": "string",
					"initialValue": "",
					"comment": "",
					"isStatic": false,
					"isConstant": false,
					"sid": 238020051166281
				},
				{
					"eventType": "variable",
					"name": "modifier",
					"type": "string",
					"initialValue": "",
					"comment": "",
					"isStatic": false,
					"isConstant": false,
					"sid": 262832898982935
				},
				{
					"eventType": "comment",
					"text": "Generate upgrade options and show update level up UI"
				},
				{
					"eventType": "comment",
					"text": "This is an inelegant solution to the problem that we need multiple (ideally 3) unique upgrade options, which should be chosen based on their weight"
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "repeat",
							"objectClass": "System",
							"sid": 850797514658563,
							"parameters": {
								"count": "100"
							}
						},
						{
							"id": "compare-instance-variable",
							"objectClass": "UI_Button9P_Upgrade",
							"sid": 290392294712659,
							"parameters": {
								"instance-variable": "modifier",
								"comparison": 0,
								"value": "EMPTY"
							}
						},
						{
							"id": "pick-highestlowest",
							"objectClass": "UI_Button9P_Upgrade",
							"sid": 519292572309658,
							"parameters": {
								"which": "lowest",
								"instance-variable": "option"
							}
						},
						{
							"id": "pick-children",
							"objectClass": "UI_Button9P_Upgrade",
							"sid": 848658632286199,
							"parameters": {
								"child": "UI_TextSF_Upgrade",
								"which": "own"
							}
						},
						{
							"id": "pick-children",
							"objectClass": "UI_Button9P_Upgrade",
							"sid": 595803783118286,
							"parameters": {
								"child": "Icon",
								"which": "own"
							}
						}
					],
					"actions": [
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 208629903418153,
							"parameters": {
								"variable": "upgradeCandidate",
								"value": "AdvancedRandom.WeightedByName(PT_Upgrades)"
							}
						},
						{
							"id": "log",
							"objectClass": "Browser",
							"sid": 217245850990327,
							"disabled": true,
							"parameters": {
								"type": "log",
								"message": "\"Upgrade candidate: \" & upgradeCandidate"
							}
						},
						{
							"type": "comment",
							"text": "If upgrade candidate not unique, clear it"
						},
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 215952326742553,
							"parameters": {
								"variable": "upgradeCandidate",
								"value": "UpgradeOptions.IndexOf(upgradeCandidate) = NOTHING ? upgradeCandidate : EMPTY"
							}
						},
						{
							"id": "log",
							"objectClass": "Browser",
							"sid": 248553856758531,
							"disabled": true,
							"parameters": {
								"type": "log",
								"message": "\"Update candidate after first validation: \" & upgradeCandidate"
							}
						},
						{
							"type": "comment",
							"text": "Validate if upgrade has modifiers"
						},
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 386060348102497,
							"parameters": {
								"variable": "upgradeCandidate",
								"value": "Rules.ArraySize(KEY_Upgrades & DOT & upgradeCandidate & DOT & KEY_Modifiers) > 0 | Rules.ArraySize(KEY_Upgrades & DOT & upgradeCandidate & DOT & KEY_Modifiers_Infinite) > 0 ? upgradeCandidate : EMPTY"
							}
						},
						{
							"id": "log",
							"objectClass": "Browser",
							"sid": 553004739551527,
							"disabled": true,
							"parameters": {
								"type": "log",
								"message": "\"Update candidate after second validation: \" & upgradeCandidate"
							}
						},
						{
							"type": "comment",
							"text": "Set modifier"
						},
						{
							"id": "set-eventvar-value",
							"objectClass": "System",
							"sid": 649313746691351,
							"parameters": {
								"variable": "modifier",
								"value": "Rules.ArraySize(KEY_Upgrades & DOT & upgradeCandidate & DOT & KEY_Modifiers) > 0 ?\nRules.Get(KEY_Upgrades & DOT & upgradeCandidate & DOT & KEY_Modifiers & DOT & \"0\") :\n(\n  Rules.ArraySize(KEY_Upgrades & DOT & upgradeCandidate & DOT & KEY_Modifiers_Infinite) > 0 ?\n  Rules.Get(KEY_Upgrades & DOT & upgradeCandidate & DOT & KEY_Modifiers_Infinite & DOT & \"0\") :\n  EMPTY\n)"
							}
						},
						{
							"type": "comment",
							"text": "Use upgrade candidate (if it's still a valid one)"
						},
						{
							"id": "set-instvar-value",
							"objectClass": "UI_Button9P_Upgrade",
							"sid": 259307422504496,
							"parameters": {
								"instance-variable": "upgrade",
								"value": "upgradeCandidate"
							}
						},
						{
							"id": "set-instvar-value",
							"objectClass": "UI_Button9P_Upgrade",
							"sid": 116131577307368,
							"parameters": {
								"instance-variable": "modifier",
								"value": "modifier"
							}
						},
						{
							"id": "set-opacity",
							"objectClass": "UI_Button9P_Upgrade",
							"sid": 376101786744360,
							"parameters": {
								"opacity": "upgradeCandidate = EMPTY ? 0 : 100"
							}
						},
						{
							"id": "set-animation",
							"objectClass": "Icon",
							"sid": 484903702747816,
							"parameters": {
								"animation": "Rules.Get(KEY_Modifiers & DOT & modifier & DOT & KEY_Icon)",
								"from": "beginning"
							}
						},
						{
							"id": "set-text",
							"objectClass": "UI_TextSF_Upgrade",
							"sid": 716582881851718,
							"parameters": {
								"text": "(modifier = EMPTY ? EMPTY : \"[scale=0.15]\" & Rules.Get(KEY_Modifiers & DOT & modifier & DOT & KEY_Label) & \"[/scale]\" & newline & Rules.Get(KEY_Modifiers & DOT & modifier & DOT & KEY_Description))"
							}
						},
						{
							"id": "push",
							"objectClass": "UpgradeOptions",
							"sid": 994293527720367,
							"parameters": {
								"where": "back",
								"value": "upgradeCandidate",
								"axis": "x"
							}
						}
					],
					"sid": 453279715358873
				}
			]
		},
		{
			"aceType": "action",
			"aceName": "tick_takeDamage",
			"objectClass": "Player",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionCopyPicked": false,
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "custom-ace-block",
			"conditions": [
				{
					"id": "is-overlapping-another-object",
					"objectClass": "PlayerHurtbox",
					"sid": 215196772925861,
					"parameters": {
						"object": "Enemy"
					}
				},
				{
					"id": "is-timer-running",
					"objectClass": "Player",
					"sid": 276431174221574,
					"behaviorType": "Timer",
					"parameters": {
						"tag": "TIMER_Freeze_All"
					},
					"isInverted": true
				},
				{
					"id": "is-timer-running",
					"objectClass": "Enemy",
					"sid": 900749640864772,
					"behaviorType": "Timer",
					"parameters": {
						"tag": "TIMER_Freeze"
					},
					"isInverted": true
				},
				{
					"id": "compare-instance-variable",
					"objectClass": "Enemy",
					"sid": 666999215744724,
					"parameters": {
						"instance-variable": "damage",
						"comparison": 4,
						"value": "0"
					}
				},
				{
					"id": "compare-instance-variable",
					"objectClass": "Enemy",
					"sid": 574919279917018,
					"parameters": {
						"instance-variable": "isDead",
						"comparison": 0,
						"value": "NO"
					}
				},
				{
					"id": "for-each",
					"objectClass": "System",
					"sid": 764339309438728,
					"parameters": {
						"object": "Enemy"
					}
				}
			],
			"actions": [
				{
					"customAction": "playSFX",
					"objectClass": "Audio",
					"sid": 343619360425579,
					"parameters": [
						"SFX_PlayerDamaged",
						"3",
						"Enemy.damage > 0 ? 1 : 0"
					]
				},
				{
					"type": "comment",
					"text": "Decrease player health"
				},
				{
					"id": "set-value",
					"objectClass": "Rules",
					"sid": 417252591317647,
					"parameters": {
						"path": "KEY_Player & DOT & KEY_Health",
						"value": "max(0, Rules.Get(KEY_Player & DOT & KEY_Health) - (Enemy.damage * dt * Rules.Get(KEY_Player & DOT & KEY_Bonus_Incoming_Damage_Multiplier)))"
					}
				},
				{
					"type": "comment",
					"text": "Set player to hurting (for vignette UI effect)"
				},
				{
					"id": "set-instvar-value",
					"objectClass": "Player",
					"sid": 940597314678305,
					"parameters": {
						"instance-variable": "isHurt",
						"value": "Enemy.damage > 0 ? YES : NO"
					}
				},
				{
					"type": "comment",
					"text": "Start damage flash on & off timers if they are not running yet"
				},
				{
					"id": "start-timer",
					"objectClass": "Player",
					"sid": 854253537586009,
					"behaviorType": "Timer",
					"parameters": {
						"duration": "C_Damage_Flash_Interval",
						"type": "once",
						"tag": "Self.Timer.CurrentTime(TIMER_FlashOn) = 0 &\nSelf.Timer.CurrentTime(TIMER_FlashOff) = 0\n? TIMER_FlashOn : EMPTY"
					}
				},
				{
					"id": "start-timer",
					"objectClass": "Player",
					"sid": 323006303895966,
					"behaviorType": "Timer",
					"parameters": {
						"duration": "C_Damage_Flash_Interval * 2",
						"type": "once",
						"tag": "Self.Timer.CurrentTime(TIMER_FlashOn) > 0 &\nSelf.Timer.CurrentTime(TIMER_FlashOff) = 0\n? TIMER_FlashOff : EMPTY"
					}
				}
			],
			"sid": 712392008794518
		},
		{
			"aceType": "action",
			"aceName": "tick_healthCheck",
			"objectClass": "Player",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionCopyPicked": false,
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "custom-ace-block",
			"conditions": [
				{
					"id": "compare-value",
					"objectClass": "Rules",
					"sid": 913902116645606,
					"parameters": {
						"path": "KEY_Player & DOT & KEY_Health",
						"cmp": 0,
						"value": "0"
					}
				}
			],
			"actions": [
				{
					"type": "comment",
					"text": "Kill player if they are out of health"
				},
				{
					"customAction": "playSFX",
					"objectClass": "Audio",
					"sid": 721240114321395,
					"parameters": [
						"SFX_PlayerDead",
						"0",
						"1"
					]
				},
				{
					"id": "set-instvar-value",
					"objectClass": "Player",
					"sid": 395506935754137,
					"parameters": {
						"instance-variable": "isDead",
						"value": "YES"
					}
				},
				{
					"type": "comment",
					"text": "Show game over text"
				},
				{
					"id": "create-object",
					"objectClass": "System",
					"sid": 856169019054401,
					"parameters": {
						"object-to-create": "UI_TextSF_GameOver",
						"layer": "LAYER_UI",
						"x": "ViewportMidX(LAYER_UI)",
						"y": "ViewportMidY(LAYER_UI)",
						"create-hierarchy": false,
						"template-name": "\"\""
					}
				},
				{
					"type": "comment",
					"text": "Stop animation"
				},
				{
					"id": "stop-animation",
					"objectClass": "Player",
					"sid": 926745807737879
				},
				{
					"type": "comment",
					"text": "Slow down moving drops"
				},
				{
					"id": "set-acceleration",
					"objectClass": "Drop",
					"sid": 424814984230285,
					"behaviorType": "Bullet",
					"parameters": {
						"acceleration": "-Self.Bullet.Speed * 0.5"
					}
				},
				{
					"type": "comment",
					"text": "Disable player movement"
				},
				{
					"id": "set-enabled",
					"objectClass": "Player",
					"sid": 194591845780256,
					"behaviorType": "8Direction",
					"parameters": {
						"state": "disabled"
					}
				},
				{
					"type": "comment",
					"text": "Disable player-physics (don't keep pushing away enemies)"
				},
				{
					"id": "set-enabled",
					"objectClass": "Player",
					"sid": 772499342138245,
					"behaviorType": "Physics",
					"parameters": {
						"mode": "disabled"
					}
				},
				{
					"type": "comment",
					"text": "Flash player"
				},
				{
					"id": "set-default-color",
					"objectClass": "Player",
					"sid": 421173815202768,
					"parameters": {
						"color": "rgbEx(500, 500, 500)"
					}
				},
				{
					"type": "comment",
					"text": "Fade out player"
				},
				{
					"id": "tween-one-property",
					"objectClass": "Player",
					"sid": 109592256412946,
					"behaviorType": "Tween",
					"parameters": {
						"tags": "\"\"",
						"property": "offsetOpacity",
						"end-value": "0",
						"time": "3",
						"ease": "easeoutcubic",
						"destroy-on-complete": "no",
						"loop": "no",
						"ping-pong": "no",
						"repeat-count": "1"
					}
				},
				{
					"id": "tween-one-property",
					"objectClass": "UI_Rectangle_Background",
					"sid": 826559495502923,
					"behaviorType": "Tween",
					"parameters": {
						"tags": "\"\"",
						"property": "offsetOpacity",
						"end-value": "50",
						"time": "2",
						"ease": "easeoutcubic",
						"destroy-on-complete": "no",
						"loop": "no",
						"ping-pong": "no",
						"repeat-count": "1"
					}
				}
			],
			"sid": 789487943492872
		},
		{
			"aceType": "action",
			"aceName": "tick_input",
			"objectClass": "Player",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionCopyPicked": false,
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "custom-ace-block",
			"conditions": [
				{
					"id": "compare-eventvar",
					"objectClass": "System",
					"sid": 844885624716234,
					"parameters": {
						"variable": "isLeveling",
						"comparison": 0,
						"value": "NO"
					}
				}
			],
			"actions": [
				{
					"type": "comment",
					"text": "Reset player input IVs"
				},
				{
					"id": "set-instvar-value",
					"objectClass": "Player",
					"sid": 954428231497829,
					"parameters": {
						"instance-variable": "IN_Movement_Active",
						"value": "NO"
					}
				},
				{
					"id": "set-instvar-value",
					"objectClass": "Player",
					"sid": 177688051001749,
					"parameters": {
						"instance-variable": "IN_Vector_X",
						"value": "0"
					}
				},
				{
					"id": "set-instvar-value",
					"objectClass": "Player",
					"sid": 978730537400933,
					"parameters": {
						"instance-variable": "IN_Vector_Y",
						"value": "0"
					}
				},
				{
					"type": "comment",
					"text": "Process touch input (virtual analog)"
				},
				{
					"type": "comment",
					"text": "Update touch marker position when a touch starts"
				},
				{
					"id": "set-position",
					"objectClass": "UI_TouchMarker",
					"sid": 240126968222626,
					"parameters": {
						"x": "Self.Opacity = 0 & Touch.TouchCount > 0 ? Touch.XAt(0, LAYER_UI) : Self.X",
						"y": "Self.Opacity = 0 & Touch.TouchCount > 0 ? Touch.YAt(0, LAYER_UI) : Self.Y"
					}
				},
				{
					"id": "set-opacity",
					"objectClass": "UI_TouchMarker",
					"sid": 362974513022887,
					"parameters": {
						"opacity": "Touch.TouchCount > 0 ? 100 : 0"
					}
				},
				{
					"type": "comment",
					"text": "Update player's input IVs if touch input is active"
				},
				{
					"id": "set-instvar-value",
					"objectClass": "Player",
					"sid": 519892987291122,
					"parameters": {
						"instance-variable": "IN_Movement_Active",
						"value": "Touch.TouchCount > 0 & distance(UI_TouchMarker.X, UI_TouchMarker.Y, Touch.XAt(0, LAYER_UI), Touch.YAt(0, LAYER_UI)) > UI_TouchMarker.Width * 0.5 ? YES : NO"
					}
				},
				{
					"id": "set-instvar-value",
					"objectClass": "Player",
					"sid": 645690472933423,
					"parameters": {
						"instance-variable": "IN_Movement_Angle",
						"value": "Touch.TouchCount > 0 & distance(UI_TouchMarker.X, UI_TouchMarker.Y, Touch.XAt(0, LAYER_UI), Touch.YAt(0, LAYER_UI)) > UI_TouchMarker.Width * 0.5 ?\nangle(UI_TouchMarker.X, UI_TouchMarker.Y, Touch.XAt(0, LAYER_UI), Touch.YAt(0, LAYER_UI)) :\nSelf.IN_Movement_Angle"
					}
				},
				{
					"type": "comment",
					"text": "Update touch marker angle & animation"
				},
				{
					"id": "set-angle",
					"objectClass": "UI_TouchMarker",
					"sid": 255546664704000,
					"parameters": {
						"angle": "Touch.TouchCount >0 & distance(UI_TouchMarker.X, UI_TouchMarker.Y, Touch.XAt(0, LAYER_UI), Touch.YAt(0, LAYER_UI)) > UI_TouchMarker.Width * 0.5 ? Player.IN_Movement_Angle : Self.Angle"
					}
				},
				{
					"id": "set-animation",
					"objectClass": "UI_TouchMarker",
					"sid": 904259989300354,
					"parameters": {
						"animation": "distance(UI_TouchMarker.X, UI_TouchMarker.Y, Touch.XAt(0, LAYER_UI), Touch.YAt(0, LAYER_UI)) > UI_TouchMarker.Width * 0.5 ? ANIM_Arrow : ANIM_Default",
						"from": "beginning"
					}
				}
			],
			"sid": 823782812326942,
			"children": [
				{
					"eventType": "comment",
					"text": "Process keyboard & gamepad D-pad (digital) input"
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "key-is-down",
							"objectClass": "Keyboard",
							"sid": 772246255168906,
							"parameters": {
								"key": 87
							}
						},
						{
							"id": "key-is-down",
							"objectClass": "Keyboard",
							"sid": 786399882874846,
							"parameters": {
								"key": 38
							}
						},
						{
							"id": "is-button-down",
							"objectClass": "Gamepad",
							"sid": 805028382977787,
							"parameters": {
								"gamepad": "0",
								"button": "d-pad-up"
							}
						}
					],
					"actions": [
						{
							"type": "comment",
							"text": "Up"
						},
						{
							"id": "set-instvar-value",
							"objectClass": "Player",
							"sid": 680243255169599,
							"parameters": {
								"instance-variable": "IN_Movement_Active",
								"value": "YES"
							}
						},
						{
							"id": "subtract-from-instvar",
							"objectClass": "Player",
							"sid": 379931190030021,
							"parameters": {
								"instance-variable": "IN_Vector_Y",
								"value": "1"
							}
						}
					],
					"sid": 581718632324741,
					"isOrBlock": true
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "key-is-down",
							"objectClass": "Keyboard",
							"sid": 834502893889159,
							"parameters": {
								"key": 83
							}
						},
						{
							"id": "key-is-down",
							"objectClass": "Keyboard",
							"sid": 896657789915836,
							"parameters": {
								"key": 40
							}
						},
						{
							"id": "is-button-down",
							"objectClass": "Gamepad",
							"sid": 717498175393543,
							"parameters": {
								"gamepad": "0",
								"button": "d-pad-down"
							}
						}
					],
					"actions": [
						{
							"type": "comment",
							"text": "Down"
						},
						{
							"id": "set-instvar-value",
							"objectClass": "Player",
							"sid": 647010615786517,
							"parameters": {
								"instance-variable": "IN_Movement_Active",
								"value": "YES"
							}
						},
						{
							"id": "add-to-instvar",
							"objectClass": "Player",
							"sid": 463085651783216,
							"parameters": {
								"instance-variable": "IN_Vector_Y",
								"value": "1"
							}
						}
					],
					"sid": 812801529942632,
					"isOrBlock": true
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "key-is-down",
							"objectClass": "Keyboard",
							"sid": 276593055585175,
							"parameters": {
								"key": 65
							}
						},
						{
							"id": "key-is-down",
							"objectClass": "Keyboard",
							"sid": 937706129584026,
							"parameters": {
								"key": 37
							}
						},
						{
							"id": "is-button-down",
							"objectClass": "Gamepad",
							"sid": 957800495108569,
							"parameters": {
								"gamepad": "0",
								"button": "d-pad-left"
							}
						}
					],
					"actions": [
						{
							"type": "comment",
							"text": "Left"
						},
						{
							"id": "set-instvar-value",
							"objectClass": "Player",
							"sid": 112032855513694,
							"parameters": {
								"instance-variable": "IN_Movement_Active",
								"value": "YES"
							}
						},
						{
							"id": "subtract-from-instvar",
							"objectClass": "Player",
							"sid": 173675738846566,
							"parameters": {
								"instance-variable": "IN_Vector_X",
								"value": "1"
							}
						}
					],
					"sid": 108543780388197,
					"isOrBlock": true
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "key-is-down",
							"objectClass": "Keyboard",
							"sid": 597351052477431,
							"parameters": {
								"key": 68
							}
						},
						{
							"id": "key-is-down",
							"objectClass": "Keyboard",
							"sid": 615239764408925,
							"parameters": {
								"key": 39
							}
						},
						{
							"id": "is-button-down",
							"objectClass": "Gamepad",
							"sid": 561846695332405,
							"parameters": {
								"gamepad": "0",
								"button": "d-pad-right"
							}
						}
					],
					"actions": [
						{
							"type": "comment",
							"text": "Right"
						},
						{
							"id": "set-instvar-value",
							"objectClass": "Player",
							"sid": 670216901044388,
							"parameters": {
								"instance-variable": "IN_Movement_Active",
								"value": "YES"
							}
						},
						{
							"id": "add-to-instvar",
							"objectClass": "Player",
							"sid": 165518113987227,
							"parameters": {
								"instance-variable": "IN_Vector_X",
								"value": "1"
							}
						}
					],
					"sid": 971231662640716,
					"isOrBlock": true
				},
				{
					"eventType": "comment",
					"text": "Process gamepad / joystick (analog) input"
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "compare-axis",
							"objectClass": "Gamepad",
							"sid": 270446686242941,
							"parameters": {
								"gamepad": "0",
								"axis": "left-analog-x-axis",
								"comparison": 1,
								"value": "0"
							}
						},
						{
							"id": "compare-axis",
							"objectClass": "Gamepad",
							"sid": 667677360565018,
							"parameters": {
								"gamepad": "0",
								"axis": "left-analog-y-axis",
								"comparison": 1,
								"value": "0"
							}
						},
						{
							"id": "compare-axis",
							"objectClass": "Gamepad",
							"sid": 488216473442178,
							"parameters": {
								"gamepad": "0",
								"axis": "right-analog-x-axis",
								"comparison": 1,
								"value": "0"
							}
						},
						{
							"id": "compare-axis",
							"objectClass": "Gamepad",
							"sid": 164447874212789,
							"parameters": {
								"gamepad": "0",
								"axis": "right-analog-y-axis",
								"comparison": 1,
								"value": "0"
							}
						}
					],
					"actions": [
						{
							"id": "set-instvar-value",
							"objectClass": "Player",
							"sid": 218995351776755,
							"parameters": {
								"instance-variable": "IN_Movement_Active",
								"value": "YES"
							}
						},
						{
							"id": "set-instvar-value",
							"objectClass": "Player",
							"sid": 179189209428264,
							"parameters": {
								"instance-variable": "IN_Vector_X",
								"value": "Gamepad.Axis(0, 0) + Gamepad.Axis(0, 2)"
							}
						},
						{
							"id": "set-instvar-value",
							"objectClass": "Player",
							"sid": 399838042645245,
							"parameters": {
								"instance-variable": "IN_Vector_Y",
								"value": "Gamepad.Axis(0, 1) + Gamepad.Axis(0, 3)"
							}
						}
					],
					"sid": 975737648800403,
					"isOrBlock": true
				},
				{
					"eventType": "comment",
					"text": "Process mouse (move to cursor analog) input"
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "mouse-button-is-down",
							"objectClass": "Mouse",
							"sid": 643420804898053,
							"parameters": {
								"mouse-button": "left"
							}
						}
					],
					"actions": [
						{
							"id": "set-instvar-value",
							"objectClass": "Player",
							"sid": 231995645554363,
							"parameters": {
								"instance-variable": "IN_Movement_Active",
								"value": "YES"
							}
						},
						{
							"id": "set-instvar-value",
							"objectClass": "Player",
							"sid": 298749149706691,
							"parameters": {
								"instance-variable": "IN_Movement_Angle",
								"value": "angle(Self.X, Self.Y, Mouse.X, Mouse.Y)"
							}
						}
					],
					"sid": 345144455692634
				}
			]
		},
		{
			"aceType": "action",
			"aceName": "tick_attack",
			"objectClass": "Player",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionCopyPicked": false,
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "custom-ace-block",
			"conditions": [
				{
					"id": "for-each",
					"objectClass": "Rules",
					"sid": 174480782636585,
					"parameters": {
						"path": "KEY_Weapons"
					}
				},
				{
					"id": "compare-value",
					"objectClass": "Rules",
					"sid": 184166043939085,
					"parameters": {
						"path": "DOT & KEY_Amount",
						"cmp": 5,
						"value": "1"
					}
				},
				{
					"id": "is-timer-running",
					"objectClass": "Player",
					"sid": 799821860525253,
					"behaviorType": "Timer",
					"parameters": {
						"tag": "TIMER_Weapon_Attack_ & Rules.CurrentKey"
					},
					"isInverted": true
				}
			],
			"actions": [
				{
					"type": "comment",
					"text": "Attack with weapon with at least one amount and if their cooldown timer is not running"
				},
				{
					"type": "comment",
					"text": "Start attack cooldown timer"
				},
				{
					"id": "start-timer",
					"objectClass": "Player",
					"sid": 570041474817079,
					"behaviorType": "Timer",
					"parameters": {
						"duration": "Rules.Get(DOT & KEY_Cooldown) * Rules.Get(KEY_Player & DOT & KEY_Bonus_Weapon_Cooldown_Multiplier)",
						"type": "once",
						"tag": "TIMER_Weapon_Attack_ & Rules.CurrentKey"
					}
				},
				{
					"type": "comment",
					"text": "Spawn weapon(s) / attack"
				},
				{
					"customAction": "spawn",
					"objectClass": "Weapon",
					"sid": 263440204921821,
					"parameters": [
						"Rules.CurrentKey",
						"Rules.Get(DOT & KEY_Amount) + Rules.Get(KEY_Player & DOT & KEY_Bonus_Weapon_Amount)",
						"Rules.Get(DOT & KEY_Damage)",
						"Rules.Get(DOT & KEY_Duration)",
						"Rules.Get(DOT & KEY_BlockMovement) = NO ? NO : YES",
						"Rules.Get(DOT & KEY_Pin) = NO ? NO : YES",
						"Player.lastMovingAngle + Rules.Get(DOT & KEY_SpawnAngleOffset)",
						"Rules.Get(DOT & KEY_RotationAngleOffset)",
						"Rules.Type(DOT & KEY_StaticAngle) = NULL ? EMPTY : str(Rules.Get(DOT & KEY_StaticAngle))",
						"Rules.Get(DOT & KEY_Scale) * Rules.Get(KEY_Player & DOT & KEY_Bonus_Weapon_Size_Multiplier)",
						"random(-Rules.Get(DOT & KEY_PositionRandom1), Rules.Get(DOT & KEY_PositionRandom1))",
						"random(-Rules.Get(DOT & KEY_PositionRandom1), Rules.Get(DOT & KEY_PositionRandom1))",
						"Rules.Get(DOT & KEY_PositionRandom2)",
						"Rules.Get(DOT & KEY_BulletSpeed)",
						"Rules.Get(DOT & KEY_BulletAcceleration)",
						"Rules.Get(DOT & KEY_OrbitRadius)",
						"Rules.Get(DOT & KEY_OrbitSpeed)",
						"Rules.Get(DOT & KEY_RotationSpeed)"
					]
				}
			],
			"sid": 768367347814953
		},
		{
			"aceType": "action",
			"aceName": "tick_spawnCycle",
			"objectClass": "Player",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionCopyPicked": false,
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "custom-ace-block",
			"conditions": [
				{
					"id": "is-timer-running",
					"objectClass": "Player",
					"sid": 846800341537685,
					"behaviorType": "Timer",
					"parameters": {
						"tag": "TIMER_SpawnCycle"
					},
					"isInverted": true
				}
			],
			"actions": [
				{
					"type": "comment",
					"text": "When the enemy spawn cooldown expires, reset it & add enemy amount to the spawn queue"
				},
				{
					"type": "comment",
					"text": "Increase wave cycle counter"
				},
				{
					"id": "add-to-eventvar",
					"objectClass": "System",
					"sid": 245084156722990,
					"parameters": {
						"variable": "spawnCycle",
						"value": "1"
					}
				},
				{
					"type": "comment",
					"text": "Start next wave cycle timer"
				},
				{
					"id": "start-timer",
					"objectClass": "Player",
					"sid": 351057059123665,
					"behaviorType": "Timer",
					"parameters": {
						"duration": "Rules.Get(KEY_Level & DOT & KEY_SpawnInterval)",
						"type": "once",
						"tag": "TIMER_SpawnCycle"
					}
				},
				{
					"type": "comment",
					"text": "Add enemy amount to spawn queue"
				},
				{
					"id": "add-to-eventvar",
					"objectClass": "System",
					"sid": 272383174403206,
					"parameters": {
						"variable": "enemySpawnQueue",
						"value": "round(Rules.Get(KEY_Waves & DOT & waveId & DOT & KEY_EnemyAmount) / Rules.Get(KEY_Waves & DOT & waveId & DOT & KEY_Time)) * Rules.Get(KEY_Level & DOT & KEY_SpawnInterval) * Rules.Get(KEY_Player & DOT & KEY_Bonus_Enemy_Spawn_Amount_Multiplier)"
					}
				}
			],
			"sid": 698877660721366
		},
		{
			"aceType": "action",
			"aceName": "tick_itemPickups",
			"objectClass": "Player",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionCopyPicked": false,
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "custom-ace-block",
			"conditions": [
				{
					"id": "is-overlapping-another-object",
					"objectClass": "Player",
					"sid": 332578672363300,
					"parameters": {
						"object": "Item"
					}
				},
				{
					"id": "compare-instance-variable",
					"objectClass": "Item",
					"sid": 302812988967815,
					"parameters": {
						"instance-variable": "isPickedUp",
						"comparison": 0,
						"value": "NO"
					}
				}
			],
			"actions": [
				{
					"type": "comment",
					"text": "Update \"picked up\" state"
				},
				{
					"id": "set-instvar-value",
					"objectClass": "Item",
					"sid": 614026837795589,
					"parameters": {
						"instance-variable": "isPickedUp",
						"value": "YES"
					}
				},
				{
					"type": "comment",
					"text": "Apply \"item\" (upgrade)"
				},
				{
					"customAction": "applyModifier",
					"objectClass": "Player",
					"sid": 135214136234939,
					"parameters": [
						"Item.modifier"
					]
				},
				{
					"type": "comment",
					"text": "Flash and fade out item"
				},
				{
					"id": "set-default-color",
					"objectClass": "Item",
					"sid": 395634840693893,
					"parameters": {
						"color": "rgbEx(500, 500, 500)"
					}
				},
				{
					"id": "stop-all-tweens",
					"objectClass": "Item",
					"sid": 285032564911987,
					"behaviorType": "Tween"
				},
				{
					"id": "set-opacity",
					"objectClass": "Item",
					"sid": 579580890222572,
					"parameters": {
						"opacity": "100"
					}
				},
				{
					"id": "tween-one-property",
					"objectClass": "Item",
					"sid": 815032192118742,
					"behaviorType": "Tween",
					"parameters": {
						"tags": "\"\"",
						"property": "offsetOpacity",
						"end-value": "0",
						"time": "1",
						"ease": "easeoutexpo",
						"destroy-on-complete": "yes",
						"loop": "no",
						"ping-pong": "no",
						"repeat-count": "1"
					}
				}
			],
			"sid": 811100200491126
		},
		{
			"aceType": "action",
			"aceName": "tick_wave",
			"objectClass": "Player",
			"functionDescription": "If there's no wave in progress, start one",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionCopyPicked": false,
			"functionIsAsync": false,
			"functionParameters": [],
			"eventType": "custom-ace-block",
			"conditions": [
				{
					"id": "compare-eventvar",
					"objectClass": "System",
					"sid": 899796644566916,
					"parameters": {
						"variable": "isLeveling",
						"comparison": 0,
						"value": "NO"
					}
				},
				{
					"id": "compare-eventvar",
					"objectClass": "System",
					"sid": 258673283578829,
					"parameters": {
						"variable": "isPaused",
						"comparison": 0,
						"value": "NO"
					}
				},
				{
					"id": "is-timer-running",
					"objectClass": "Player",
					"sid": 135498244222749,
					"behaviorType": "Timer",
					"parameters": {
						"tag": "TIMER_Wave"
					},
					"isInverted": true
				}
			],
			"actions": [
				{
					"type": "comment",
					"text": "Reset cycle counter"
				},
				{
					"id": "set-eventvar-value",
					"objectClass": "System",
					"sid": 681862890012938,
					"parameters": {
						"variable": "spawnCycle",
						"value": "0"
					}
				},
				{
					"type": "comment",
					"text": "Increase wave counter"
				},
				{
					"id": "add-to-eventvar",
					"objectClass": "System",
					"sid": 447034496823719,
					"parameters": {
						"variable": "waveId",
						"value": "1"
					}
				},
				{
					"id": "add-to-eventvar",
					"objectClass": "System",
					"sid": 356763451186596,
					"parameters": {
						"variable": "waveCount",
						"value": "1"
					}
				},
				{
					"type": "comment",
					"text": "If wave counter is invalid, reset it (to specified wave number)"
				},
				{
					"id": "set-eventvar-value",
					"objectClass": "System",
					"sid": 415270100861037,
					"parameters": {
						"variable": "waveId",
						"value": "Rules.Get(KEY_Waves & DOT & waveId & DOT & KEY_Time) = 0 ? Rules.Get(KEY_Level & DOT & KEY_WaveLoopTo) : waveId"
					}
				},
				{
					"id": "log",
					"objectClass": "Browser",
					"sid": 949451974426900,
					"disabled": true,
					"parameters": {
						"type": "log",
						"message": "\"Wave #\" & waveId & \" enemy pool: \" & Rules.GetAsCompactString(KEY_Waves & DOT & waveId & DOT & KEY_EnemySpawnPool)"
					}
				},
				{
					"type": "comment",
					"text": "Initialize enemy spawn pool"
				},
				{
					"id": "createProbabilityTableFromJSON",
					"objectClass": "AdvancedRandom",
					"sid": 235171129713881,
					"parameters": {
						"name": "PT_Enemies",
						"json": "Rules.GetAsCompactString(KEY_Waves & DOT & waveId & DOT & KEY_EnemySpawnPool)"
					}
				},
				{
					"id": "log",
					"objectClass": "Browser",
					"sid": 257884264819011,
					"disabled": true,
					"parameters": {
						"type": "log",
						"message": "\"Wave #\" & waveId & \" enemy pool: \" & Rules.GetAsCompactString(KEY_Waves & DOT & waveId & DOT & KEY_ItemSpawnPool)"
					}
				},
				{
					"type": "comment",
					"text": "Initialize item spawn pool"
				},
				{
					"id": "createProbabilityTableFromJSON",
					"objectClass": "AdvancedRandom",
					"sid": 249991923841289,
					"parameters": {
						"name": "PT_Items",
						"json": "Rules.GetAsCompactString(KEY_Waves & DOT & waveId & DOT & KEY_ItemSpawnPool)"
					}
				},
				{
					"type": "comment",
					"text": "Start wave cooldown timer (also triggers first wave cycle)"
				},
				{
					"id": "start-timer",
					"objectClass": "Player",
					"sid": 627664346708544,
					"behaviorType": "Timer",
					"parameters": {
						"duration": "Rules.Get(KEY_Waves & DOT & waveId & DOT & KEY_Time)",
						"type": "once",
						"tag": "TIMER_Wave"
					}
				},
				{
					"type": "comment",
					"text": "Cue item spawn"
				},
				{
					"id": "set-eventvar-value",
					"objectClass": "System",
					"sid": 584799519464070,
					"parameters": {
						"variable": "itemSpawnCue",
						"value": "Rules.ArraySize(KEY_Waves & DOT & waveId & DOT & KEY_EnemySpawnPool) > 0 ? AdvancedRandom.WeightedByName(PT_Items) : EMPTY"
					}
				},
				{
					"type": "comment",
					"text": "Spawn wave text UI"
				},
				{
					"id": "destroy",
					"objectClass": "UI_TextSF_Wave",
					"sid": 992313115544987
				},
				{
					"id": "create-object",
					"objectClass": "System",
					"sid": 525385144159645,
					"parameters": {
						"object-to-create": "UI_TextSF_Wave",
						"layer": "LAYER_UI",
						"x": "ViewportMidX(LAYER_UI)",
						"y": "ViewportMidY(LAYER_UI) - 60",
						"create-hierarchy": false,
						"template-name": "\"\""
					}
				},
				{
					"id": "move-to-bottom",
					"objectClass": "UI_TextSF_Wave",
					"sid": 341458770524413
				},
				{
					"id": "set-text",
					"objectClass": "UI_TextSF_Wave",
					"sid": 709116856004383,
					"parameters": {
						"text": "Rules.Type(KEY_Waves & DOT & waveId & DOT & KEY_Label) = NULL ? EMPTY : Rules.Get(KEY_Waves & DOT & waveId & DOT & KEY_Label)"
					}
				},
				{
					"id": "set-opacity",
					"objectClass": "UI_TextSF_Wave",
					"sid": 221475067224664,
					"parameters": {
						"opacity": "0"
					}
				},
				{
					"id": "tween-one-property",
					"objectClass": "UI_TextSF_Wave",
					"sid": 349027221832991,
					"behaviorType": "Tween",
					"parameters": {
						"tags": "\"\"",
						"property": "offsetOpacity",
						"end-value": "100",
						"time": "Rules.Type(KEY_Waves & DOT & waveId & DOT & KEY_LabelTime) = NULL ? 1 : Rules.Get(KEY_Waves & DOT & waveId & DOT & KEY_LabelTime)",
						"ease": "easeoutexpo",
						"destroy-on-complete": "no",
						"loop": "no",
						"ping-pong": "yes",
						"repeat-count": "1"
					}
				},
				{
					"id": "tween-one-property",
					"objectClass": "UI_TextSF_Wave",
					"sid": 864868310181885,
					"behaviorType": "Tween",
					"parameters": {
						"tags": "\"\"",
						"property": "offsetY",
						"end-value": "Self.Y + 10",
						"time": "1",
						"ease": "easeoutcubic",
						"destroy-on-complete": "no",
						"loop": "no",
						"ping-pong": "no",
						"repeat-count": "1"
					}
				},
				{
					"id": "log",
					"objectClass": "Browser",
					"sid": 375816683403526,
					"parameters": {
						"type": "log",
						"message": "\"Starting wave \" & waveCount & \", ID: \" & waveId"
					}
				}
			],
			"sid": 554965157620194,
			"children": [
				{
					"eventType": "comment",
					"text": "Spawn fixed enemies at wave start"
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "for-each",
							"objectClass": "Rules",
							"sid": 194307963488648,
							"parameters": {
								"path": "KEY_Waves & DOT & waveId & DOT & KEY_EnemySpawnFixed"
							}
						}
					],
					"actions": [
						{
							"customAction": "spawn",
							"objectClass": "Enemy",
							"sid": 919417429833895,
							"parameters": [
								"Rules.CurrentKey",
								"Rules.CurrentValue"
							]
						}
					],
					"sid": 828770595183893
				},
				{
					"eventType": "comment",
					"text": "Activate modifiers"
				},
				{
					"eventType": "block",
					"conditions": [
						{
							"id": "for-each",
							"objectClass": "Rules",
							"sid": 191647997432297,
							"parameters": {
								"path": "KEY_Waves & DOT & waveId & DOT & KEY_ModifiersToApply"
							}
						}
					],
					"actions": [
						{
							"customAction": "applyModifier",
							"objectClass": "Player",
							"sid": 495291969181479,
							"parameters": [
								"Rules.CurrentValue"
							]
						}
					],
					"sid": 613024219569827
				}
			]
		},
		{
			"aceType": "action",
			"aceName": "onSelectUpgrade",
			"objectClass": "Player",
			"functionDescription": "",
			"functionCategory": "",
			"functionReturnType": "none",
			"functionCopyPicked": false,
			"functionIsAsync": false,
			"functionParameters": [
				{
					"name": "option",
					"type": "number",
					"initialValue": "0",
					"comment": "",
					"sid": 797014957186007
				}
			],
			"eventType": "custom-ace-block",
			"conditions": [
				{
					"id": "compare-eventvar",
					"objectClass": "System",
					"sid": 899906407548923,
					"parameters": {
						"variable": "isLeveling",
						"comparison": 0,
						"value": "YES"
					}
				},
				{
					"id": "compare-eventvar",
					"objectClass": "System",
					"sid": 498497197667409,
					"parameters": {
						"variable": "isPaused",
						"comparison": 0,
						"value": "NO"
					}
				},
				{
					"id": "is-any-playing",
					"objectClass": "UI_Border_LevelUp",
					"sid": 183777275047325,
					"behaviorType": "Tween",
					"isInverted": true
				},
				{
					"id": "compare-instance-variable",
					"objectClass": "UI_Button9P_Upgrade",
					"sid": 464416607872974,
					"parameters": {
						"instance-variable": "option",
						"comparison": 0,
						"value": "option"
					}
				},
				{
					"id": "pick-children",
					"objectClass": "UI_Button9P_Upgrade",
					"sid": 123743708511942,
					"parameters": {
						"child": "UI_TextSF_Upgrade",
						"which": "own"
					}
				},
				{
					"id": "compare-text",
					"objectClass": "UI_TextSF_Upgrade",
					"sid": 111540531222433,
					"parameters": {
						"text-to-compare": "EMPTY",
						"case-sensitivity": "ignore-case"
					},
					"isInverted": true
				}
			],
			"actions": [
				{
					"customAction": "playSFX",
					"objectClass": "Audio",
					"sid": 929929323156352,
					"parameters": [
						"SFX_UpgradeSelected",
						"0",
						"0.5"
					]
				},
				{
					"type": "comment",
					"text": "Highlight selected upgrade button"
				},
				{
					"id": "set-default-color",
					"objectClass": "UI_Button9P_Upgrade",
					"sid": 553291891492677,
					"parameters": {
						"color": "C_Color_Green"
					}
				},
				{
					"type": "comment",
					"text": "Spend experience"
				},
				{
					"id": "subtract-from",
					"objectClass": "Rules",
					"sid": 172350394201615,
					"parameters": {
						"path": "KEY_Player & DOT & KEY_Experience",
						"value": "Rules.Get(KEY_Player & DOT & KEY_Experience_Target)"
					}
				},
				{
					"type": "comment",
					"text": "Tween out level up UI (wait for it)"
				},
				{
					"id": "tween-one-property",
					"objectClass": "UI_Border_LevelUp",
					"sid": 837566822749427,
					"behaviorType": "Tween",
					"parameters": {
						"tags": "TWEEN_LevelUp_FadeOut",
						"property": "offsetOpacity",
						"end-value": "0",
						"time": "1",
						"ease": "easeinexpo",
						"destroy-on-complete": "no",
						"loop": "no",
						"ping-pong": "no",
						"repeat-count": "1"
					}
				},
				{
					"id": "wait-for-previous-actions",
					"objectClass": "System",
					"sid": 777887322997353
				},
				{
					"type": "comment",
					"text": "Hide level up UI"
				},
				{
					"id": "set-visible",
					"objectClass": "UI_Border_LevelUp",
					"sid": 787808226938946,
					"parameters": {
						"visibility": "invisible"
					}
				},
				{
					"type": "comment",
					"text": "Unset \"is leveling\" state"
				},
				{
					"id": "set-eventvar-value",
					"objectClass": "System",
					"sid": 426153536588302,
					"parameters": {
						"variable": "isLeveling",
						"value": "NO"
					}
				},
				{
					"type": "comment",
					"text": "Spend a modifier"
				},
				{
					"id": "pop-value",
					"objectClass": "Rules",
					"sid": 615377911777828,
					"parameters": {
						"where": "front",
						"path": "KEY_Upgrades & DOT & UI_Button9P_Upgrade.upgrade & DOT & KEY_Modifiers"
					}
				},
				{
					"type": "comment",
					"text": "Increase target experience"
				},
				{
					"id": "set-value",
					"objectClass": "Rules",
					"sid": 215433469077875,
					"parameters": {
						"path": "KEY_Player & DOT & KEY_Experience_Target",
						"value": "round(Rules.Get(KEY_Player & DOT & KEY_Experience_Target) * Rules.Get(KEY_Player & DOT & KEY_Experience_Target_Multiplier))"
					}
				},
				{
					"type": "comment",
					"text": "Apply selected upgrade's modifier"
				},
				{
					"customAction": "applyModifier",
					"objectClass": "Player",
					"sid": 450428395935593,
					"parameters": [
						"UI_Button9P_Upgrade.modifier"
					]
				},
				{
					"type": "comment",
					"text": "Freeze all enemies"
				},
				{
					"id": "start-timer",
					"objectClass": "Player",
					"sid": 957480099040497,
					"behaviorType": "Timer",
					"parameters": {
						"duration": "Rules.Get(KEY_Player & DOT & KEY_LevelUpFreezeTime)",
						"type": "once",
						"tag": "TIMER_Freeze_All"
					}
				},
				{
					"type": "comment",
					"text": "Resume game: restore time scale of paused objects"
				},
				{
					"id": "restore-object-time-scale",
					"objectClass": "System",
					"sid": 222614948091389,
					"parameters": {
						"object": "Player"
					}
				},
				{
					"id": "restore-object-time-scale",
					"objectClass": "System",
					"sid": 196277122481736,
					"parameters": {
						"object": "PlayerParticles"
					}
				},
				{
					"id": "restore-object-time-scale",
					"objectClass": "System",
					"sid": 809025054578776,
					"parameters": {
						"object": "Drop"
					}
				},
				{
					"id": "restore-object-time-scale",
					"objectClass": "System",
					"sid": 928378655102511,
					"parameters": {
						"object": "Weapon"
					}
				},
				{
					"id": "restore-object-time-scale",
					"objectClass": "System",
					"sid": 524246590112507,
					"parameters": {
						"object": "Enemy"
					}
				},
				{
					"id": "restore-object-time-scale",
					"objectClass": "System",
					"sid": 420789680602969,
					"parameters": {
						"object": "UI_TextSF_Damage"
					}
				},
				{
					"id": "restore-object-time-scale",
					"objectClass": "System",
					"sid": 482705797042896,
					"parameters": {
						"object": "UI_TextSF_Wave"
					}
				}
			],
			"sid": 134088445000097
		},
		{
			"aceType": "action",
			"aceName": "applyModifier",
			"objectClass": "Player",
			"functionDescription": "",
			"functionCategory": "Apply the effects of a specified modifier (after item pickups & level up upgrades)",
			"functionReturnType": "none",
			"functionCopyPicked": false,
			"functionIsAsync": false,
			"functionParameters": [
				{
					"name": "modifier",
					"type": "string",
					"initialValue": "",
					"comment": "",
					"sid": 323013347631822
				}
			],
			"eventType": "custom-ace-block",
			"conditions": [],
			"actions": [
				{
					"customAction": "playSFX",
					"objectClass": "Audio",
					"sid": 430929194251192,
					"parameters": [
						"SFX_UpgradeApplied",
						"0",
						"0.7"
					]
				},
				{
					"type": "comment",
					"text": "Apply upgrade (multiply), defaults 1 when not specified"
				},
				{
					"id": "set-value",
					"objectClass": "Rules",
					"sid": 215114442845049,
					"parameters": {
						"path": "Rules.Get(KEY_Modifiers & DOT & modifier & DOT & KEY_Rule_Value)",
						"value": "Rules.Get(Rules.Get(KEY_Modifiers & DOT & modifier & DOT & KEY_Rule_Value)) * (Rules.Type(KEY_Modifiers & DOT & modifier & DOT & KEY_Multiply) = NULL ? 1 : Rules.Get(KEY_Modifiers & DOT & modifier & DOT & KEY_Multiply))"
					}
				},
				{
					"type": "comment",
					"text": "Apply upgrade (add), defaults to 0 when not specified"
				},
				{
					"id": "add-to",
					"objectClass": "Rules",
					"sid": 644711060526061,
					"parameters": {
						"path": "Rules.Get(KEY_Modifiers & DOT & modifier & DOT & KEY_Rule_Value)",
						"value": "Rules.Get(KEY_Modifiers  & DOT & modifier & DOT & KEY_Add)"
					}
				},
				{
					"type": "comment",
					"text": "Apply upgrade (maximize via second rule), optional"
				},
				{
					"id": "set-value",
					"objectClass": "Rules",
					"sid": 684682981966172,
					"parameters": {
						"path": "Rules.Get(KEY_Modifiers & DOT & modifier & DOT & KEY_Rule_Value)",
						"value": "Rules.Get(KEY_Modifiers & DOT & modifier & DOT & KEY_Rule_Max) = 0 ? Rules.Get(Rules.Get(KEY_Modifiers & DOT & modifier & DOT & KEY_Rule_Value)) : min(Rules.Get(Rules.Get(KEY_Modifiers & DOT & modifier & DOT & KEY_Rule_Value)), Rules.Get(Rules.Get(KEY_Modifiers & DOT & modifier & DOT & KEY_Rule_Max)))"
					}
				},
				{
					"type": "comment",
					"text": "If upgrade is for weapon, stop its cooldown (triggers immediate attack)"
				},
				{
					"id": "stop-timer",
					"objectClass": "Player",
					"sid": 820544152948431,
					"behaviorType": "Timer",
					"parameters": {
						"tag": "TIMER_Weapon_Attack_ & Rules.Get(KEY_Modifiers & DOT & modifier & DOT & KEY_Weapon)"
					}
				},
				{
					"type": "comment",
					"text": "Update player' movement speed in case it changed"
				},
				{
					"id": "set-max-speed",
					"objectClass": "Player",
					"sid": 764744182789778,
					"behaviorType": "8Direction",
					"parameters": {
						"max-speed": "Rules.Get(KEY_Player & DOT & KEY_MovementSpeed)"
					}
				}
			],
			"sid": 266788838218702
		}
	],
	"sid": 562729237747902
}